{"version":3,"file":"oidc.security.service.spec.js","sourceRoot":"","sources":["oidc.security.service.spec.ts"],"names":[],"mappings":"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","sourcesContent":["import { inject, TestBed } from '@angular/core/testing';\r\nimport { RouterTestingModule } from '@angular/router/testing';\r\nimport { BrowserModule } from '@angular/platform-browser';\r\nimport { HttpClientModule } from '@angular/common/http';\r\nimport { AuthModule } from './../../index';\r\nimport { OpenIDImplicitFlowConfiguration } from './../../index';\r\nimport { OidcSecurityService } from './../../index';\r\n\r\nimport {} from 'jasmine';\r\nimport {} from 'node';\r\n\r\ndescribe('OidcSecurityService', () => {\r\n\r\n\tbeforeEach(() => {\r\n\t\tTestBed.configureTestingModule({\r\n\t\t\timports: [\r\n\t\t\t\tBrowserModule,\r\n\t\t\t\tHttpClientModule,\r\n\t\t\t\tRouterTestingModule,\r\n\t\t\t\tAuthModule.forRoot(),\r\n\t\t\t],\r\n\t\t\tproviders: [\r\n\t\t\t\tOidcSecurityService\r\n\t\t\t]\r\n\t\t});\r\n\t});\r\n\r\n\tit('createAuthorizeUrl default',\r\n\t\tinject([OidcSecurityService],\r\n\t\t\t(oidcSecurityService: OidcSecurityService) => {\r\n\r\n\t\t\t\t// let well = '{\r\n\t\t\t\t// \t\"issuer\":\"https://accounts.google.com\",\r\n\t\t\t\t// \t\"authorization_endpoint\":\"https://accounts.google.com/o/oauth2/v2/auth\",\r\n\t\t\t\t// \t\"token_endpoint\":\"https://www.googleapis.com/oauth2/v4/token\",\r\n\t\t\t\t// \t\"userinfo_endpoint\":\"https://www.googleapis.com/oauth2/v3/userinfo\",\r\n\t\t\t\t// \t\"revocation_endpoint\":\"https://accounts.google.com/o/oauth2/revoke\",\r\n\t\t\t\t// \t\"jwks_uri\":\"https://www.googleapis.com/oauth2/v3/certs\",\r\n\t\t\t\t// \t\"response_types_supported\":[ \"code\", \"token\", \"id_token\", \"codetoken\", \"codeid_token\", \"tokenid_token\", \"codetokenid_token\", \"none\" ],\r\n\t\t\t\t// \t\"subject_types_supported\":[ \"public\" ],\r\n\t\t\t\t// \t\"id_token_signing_alg_values_supported\":[ \"RS256\" ],\r\n\t\t\t\t// \t\"scopes_supported\":[ \"openid\", \"email\", \"profile\" ],\r\n\t\t\t\t// \t\"token_endpoint_auth_methods_supported\":[ \"client_secret_post\", \"client_secret_basic\" ],\r\n\t\t\t\t// \t\"claims_supported\":[ \"aud\", \"email\", \"email_verified\", \"exp\", \"family_name\", \"given_name\", \"iat\", \"iss\",\"locale\",\"name\",\"picture\",\"sub\"],\r\n\t\t\t\t// \t\"code_challenge_methods_supported\":[\"plain\",\"S256\"]}';\r\n\t\t\t\t// (oidcSecurityService as any).oidcSecurityCommon.store('wellknownendpoints', well);\r\n\r\n\t\t\t\tlet openIDImplicitFlowConfiguration = new OpenIDImplicitFlowConfiguration();\r\n\t\t\t\topenIDImplicitFlowConfiguration.stsServer = 'https://localhost:5001';\r\n\t\t\t\topenIDImplicitFlowConfiguration.redirect_url = 'https://localhost:44386';\r\n\t\t\t\topenIDImplicitFlowConfiguration.client_id = '188968487735-b1hh7k87nkkh6vv84548sinju2kpr7gn.apps.googleusercontent.com';\r\n\t\t\t\topenIDImplicitFlowConfiguration.response_type = 'id_token token';\r\n\t\t\t\topenIDImplicitFlowConfiguration.scope = 'openid email profile';\r\n\t\t\t\topenIDImplicitFlowConfiguration.post_logout_redirect_uri = 'https://localhost:44386/Unauthorized';\r\n\t\t\t\topenIDImplicitFlowConfiguration.post_login_route = '/home';\r\n\t\t\t\topenIDImplicitFlowConfiguration.forbidden_route = '/Forbidden';\r\n\t\t\t\topenIDImplicitFlowConfiguration.unauthorized_route = '/Unauthorized';\r\n\t\t\t\topenIDImplicitFlowConfiguration.start_checksession = false;\r\n\t\t\t\topenIDImplicitFlowConfiguration.silent_renew = false;\r\n\t\t\t\topenIDImplicitFlowConfiguration.silent_renew_offset_in_seconds = 0;\r\n\t\t\t\topenIDImplicitFlowConfiguration.log_console_warning_active = true;\r\n\t\t\t\topenIDImplicitFlowConfiguration.log_console_debug_active = true;\r\n\t\t\t\topenIDImplicitFlowConfiguration.max_id_token_iat_offset_allowed_in_seconds = 10;\r\n\t\t\t\topenIDImplicitFlowConfiguration.override_well_known_configuration = true;\r\n\t\t\t\topenIDImplicitFlowConfiguration.override_well_known_configuration_url = 'https://localhost:44386/wellknownconfiguration.json';\r\n\r\n\t\t\t\t(oidcSecurityService as any).authConfiguration.init(openIDImplicitFlowConfiguration);\r\n\t\t\t\t//oidcSecurityService.setupModule(openIDImplicitFlowConfiguration);\r\n\r\n\t\t\t\tlet value = (oidcSecurityService as any).createAuthorizeUrl('nonce', 'state', 'http://example');\r\n\t\t\t\tlet expectValue = 'http://example?client_id=188968487735-b1hh7k87nkkh6vv84548sinju2kpr7gn.apps.googleusercontent.com&redirect_uri=https%3A%2F%2Flocalhost%3A44386&response_type=id_token%20token&scope=openid%20email%20profile&nonce=nonce&state=state';\r\n\t\t\t\texpect(value).toEqual(expectValue);\r\n\t\t\t})\r\n\t);\r\n\r\n\t// https://docs.microsoft.com/en-us/azure/active-directory-b2c/active-directory-b2c-reference-oidc\r\n\tit('createAuthorizeUrl with custom url like active-directory-b2c',\r\n\t\tinject([OidcSecurityService],\r\n\t\t\t(oidcSecurityService: OidcSecurityService) => {\r\n\r\n\t\t\t\tlet openIDImplicitFlowConfiguration = new OpenIDImplicitFlowConfiguration();\r\n\t\t\t\topenIDImplicitFlowConfiguration.stsServer = 'https://localhost:5001';\r\n\t\t\t\topenIDImplicitFlowConfiguration.redirect_url = 'https://localhost:44386';\r\n\t\t\t\topenIDImplicitFlowConfiguration.client_id = 'myid';\r\n\t\t\t\topenIDImplicitFlowConfiguration.response_type = 'id_token token';\r\n\t\t\t\topenIDImplicitFlowConfiguration.scope = 'openid email profile';\r\n\t\t\t\topenIDImplicitFlowConfiguration.post_logout_redirect_uri = 'https://localhost:44386/Unauthorized';\r\n\t\t\t\topenIDImplicitFlowConfiguration.post_login_route = '/home';\r\n\t\t\t\topenIDImplicitFlowConfiguration.forbidden_route = '/Forbidden';\r\n\t\t\t\topenIDImplicitFlowConfiguration.unauthorized_route = '/Unauthorized';\r\n\t\t\t\topenIDImplicitFlowConfiguration.start_checksession = false;\r\n\t\t\t\topenIDImplicitFlowConfiguration.silent_renew = false;\r\n\t\t\t\topenIDImplicitFlowConfiguration.silent_renew_offset_in_seconds = 0;\r\n\t\t\t\topenIDImplicitFlowConfiguration.log_console_warning_active = true;\r\n\t\t\t\topenIDImplicitFlowConfiguration.log_console_debug_active = true;\r\n\t\t\t\topenIDImplicitFlowConfiguration.max_id_token_iat_offset_allowed_in_seconds = 10;\r\n\t\t\t\topenIDImplicitFlowConfiguration.override_well_known_configuration = true;\r\n\t\t\t\topenIDImplicitFlowConfiguration.override_well_known_configuration_url = 'https://localhost:44386/wellknownconfiguration.json';\r\n\r\n\t\t\t\t(oidcSecurityService as any).authConfiguration.init(openIDImplicitFlowConfiguration);\r\n\r\n\t\t\t\tlet value = (oidcSecurityService as any).createAuthorizeUrl('nonce', 'state', 'https://login.microsoftonline.com/fabrikamb2c.onmicrosoft.com/oauth2/v2.0/authorize?p=b2c_1_sign_in');\r\n\t\t\t\tlet expectValue = 'https://login.microsoftonline.com/fabrikamb2c.onmicrosoft.com/oauth2/v2.0/authorize?p=b2c_1_sign_in&client_id=myid&redirect_uri=https%3A%2F%2Flocalhost%3A44386&response_type=id_token%20token&scope=openid%20email%20profile&nonce=nonce&state=state';\r\n\t\t\t\texpect(value).toEqual(expectValue);\r\n\t\t\t})\r\n\t);\r\n\r\n\tit('createEndSessionUrl with azure-ad-b2c policy parameter',\r\n\t\tinject([OidcSecurityService],\r\n\t\t\t(oidcSecurityService: OidcSecurityService) => {\r\n\r\n\t\t\t\tlet openIDImplicitFlowConfiguration = new OpenIDImplicitFlowConfiguration();\r\n\t\t\t\topenIDImplicitFlowConfiguration.stsServer = 'https://localhost:5001';\r\n\t\t\t\topenIDImplicitFlowConfiguration.redirect_url = 'https://localhost:44386';\r\n\t\t\t\topenIDImplicitFlowConfiguration.client_id = 'myid';\r\n\t\t\t\topenIDImplicitFlowConfiguration.response_type = 'id_token token';\r\n\t\t\t\topenIDImplicitFlowConfiguration.scope = 'openid email profile';\r\n\t\t\t\topenIDImplicitFlowConfiguration.post_logout_redirect_uri = 'https://localhost:44386/Unauthorized';\r\n\t\t\t\topenIDImplicitFlowConfiguration.post_login_route = '/home';\r\n\t\t\t\topenIDImplicitFlowConfiguration.forbidden_route = '/Forbidden';\r\n\t\t\t\topenIDImplicitFlowConfiguration.unauthorized_route = '/Unauthorized';\r\n\t\t\t\topenIDImplicitFlowConfiguration.start_checksession = false;\r\n\t\t\t\topenIDImplicitFlowConfiguration.silent_renew = false;\r\n\t\t\t\topenIDImplicitFlowConfiguration.silent_renew_offset_in_seconds = 0;\r\n\t\t\t\topenIDImplicitFlowConfiguration.log_console_warning_active = true;\r\n\t\t\t\topenIDImplicitFlowConfiguration.log_console_debug_active = true;\r\n\t\t\t\topenIDImplicitFlowConfiguration.max_id_token_iat_offset_allowed_in_seconds = 10;\r\n\t\t\t\topenIDImplicitFlowConfiguration.override_well_known_configuration = true;\r\n\t\t\t\topenIDImplicitFlowConfiguration.override_well_known_configuration_url = 'https://localhost:44386/wellknownconfiguration.json';\r\n\r\n\t\t\t\t(oidcSecurityService as any).authConfiguration.init(openIDImplicitFlowConfiguration);\r\n\r\n\t\t\t\tlet value = (oidcSecurityService as any).createEndSessionUrl('https://login.microsoftonline.com/fabrikamb2c.onmicrosoft.com/oauth2/v2.0/logout?p=b2c_1_sign_in', 'UzI1NiIsImtpZCI6Il');\r\n\t\t\t\tlet expectValue = 'https://login.microsoftonline.com/fabrikamb2c.onmicrosoft.com/oauth2/v2.0/logout?p=b2c_1_sign_in&id_token_hint=UzI1NiIsImtpZCI6Il&post_logout_redirect_uri=https%3A%2F%2Flocalhost%3A44386%2FUnauthorized';\r\n\t\t\t\texpect(value).toEqual(expectValue);\r\n\t\t\t})\r\n\t);\r\n\r\n\tit('createAuthorizeUrl with custom value',\r\n\t\tinject([OidcSecurityService],\r\n\t\t\t(oidcSecurityService: OidcSecurityService) => {\r\n\r\n\t\t\t\tlet openIDImplicitFlowConfiguration = new OpenIDImplicitFlowConfiguration();\r\n\t\t\t\topenIDImplicitFlowConfiguration.stsServer = 'https://localhost:5001';\r\n\t\t\t\topenIDImplicitFlowConfiguration.redirect_url = 'https://localhost:44386';\r\n\t\t\t\topenIDImplicitFlowConfiguration.client_id = '188968487735-b1hh7k87nkkh6vv84548sinju2kpr7gn.apps.googleusercontent.com';\r\n\t\t\t\topenIDImplicitFlowConfiguration.response_type = 'id_token token';\r\n\t\t\t\topenIDImplicitFlowConfiguration.scope = 'openid email profile';\r\n\t\t\t\topenIDImplicitFlowConfiguration.post_logout_redirect_uri = 'https://localhost:44386/Unauthorized';\r\n\t\t\t\topenIDImplicitFlowConfiguration.post_login_route = '/home';\r\n\t\t\t\topenIDImplicitFlowConfiguration.forbidden_route = '/Forbidden';\r\n\t\t\t\topenIDImplicitFlowConfiguration.unauthorized_route = '/Unauthorized';\r\n\t\t\t\topenIDImplicitFlowConfiguration.start_checksession = false;\r\n\t\t\t\topenIDImplicitFlowConfiguration.silent_renew = false;\r\n\t\t\t\topenIDImplicitFlowConfiguration.silent_renew_offset_in_seconds = 0;\r\n\t\t\t\topenIDImplicitFlowConfiguration.log_console_warning_active = true;\r\n\t\t\t\topenIDImplicitFlowConfiguration.log_console_debug_active = true;\r\n\t\t\t\topenIDImplicitFlowConfiguration.max_id_token_iat_offset_allowed_in_seconds = 10;\r\n\t\t\t\topenIDImplicitFlowConfiguration.override_well_known_configuration = true;\r\n\t\t\t\topenIDImplicitFlowConfiguration.override_well_known_configuration_url = 'https://localhost:44386/wellknownconfiguration.json';\r\n\r\n\t\t\t\t(oidcSecurityService as any).authConfiguration.init(openIDImplicitFlowConfiguration);\r\n\r\n\t\t\t\toidcSecurityService.setCustomRequestParameters({ 'testcustom': 'customvalue' });\r\n\r\n\t\t\t\tlet value = (oidcSecurityService as any).createAuthorizeUrl('nonce', 'state', 'http://example');\r\n\t\t\t\tlet expectValue = 'http://example?client_id=188968487735-b1hh7k87nkkh6vv84548sinju2kpr7gn.apps.googleusercontent.com&redirect_uri=https%3A%2F%2Flocalhost%3A44386&response_type=id_token%20token&scope=openid%20email%20profile&nonce=nonce&state=state&testcustom=customvalue';\r\n\t\t\t\texpect(value).toEqual(expectValue);\r\n\t\t\t})\r\n\t);\r\n\r\n\tit('createAuthorizeUrl with custom values',\r\n\t\tinject([OidcSecurityService],\r\n\t\t\t(oidcSecurityService: OidcSecurityService) => {\r\n\r\n\t\t\t\tlet openIDImplicitFlowConfiguration = new OpenIDImplicitFlowConfiguration();\r\n\t\t\t\topenIDImplicitFlowConfiguration.stsServer = 'https://localhost:5001';\r\n\t\t\t\topenIDImplicitFlowConfiguration.redirect_url = 'https://localhost:44386';\r\n\t\t\t\topenIDImplicitFlowConfiguration.client_id = '188968487735-b1hh7k87nkkh6vv84548sinju2kpr7gn.apps.googleusercontent.com';\r\n\t\t\t\topenIDImplicitFlowConfiguration.response_type = 'id_token token';\r\n\t\t\t\topenIDImplicitFlowConfiguration.scope = 'openid email profile';\r\n\t\t\t\topenIDImplicitFlowConfiguration.post_logout_redirect_uri = 'https://localhost:44386/Unauthorized';\r\n\t\t\t\topenIDImplicitFlowConfiguration.post_login_route = '/home';\r\n\t\t\t\topenIDImplicitFlowConfiguration.forbidden_route = '/Forbidden';\r\n\t\t\t\topenIDImplicitFlowConfiguration.unauthorized_route = '/Unauthorized';\r\n\t\t\t\topenIDImplicitFlowConfiguration.start_checksession = false;\r\n\t\t\t\topenIDImplicitFlowConfiguration.silent_renew = false;\r\n\t\t\t\topenIDImplicitFlowConfiguration.silent_renew_offset_in_seconds = 0;\r\n\t\t\t\topenIDImplicitFlowConfiguration.log_console_warning_active = true;\r\n\t\t\t\topenIDImplicitFlowConfiguration.log_console_debug_active = true;\r\n\t\t\t\topenIDImplicitFlowConfiguration.max_id_token_iat_offset_allowed_in_seconds = 10;\r\n\t\t\t\topenIDImplicitFlowConfiguration.override_well_known_configuration = true;\r\n\t\t\t\topenIDImplicitFlowConfiguration.override_well_known_configuration_url = 'https://localhost:44386/wellknownconfiguration.json';\r\n\r\n\t\t\t\t(oidcSecurityService as any).authConfiguration.init(openIDImplicitFlowConfiguration);\r\n\r\n\t\t\t\t oidcSecurityService.setCustomRequestParameters({ 't4': 'ABC abc 123', 't3': '#', 't2': '-_.!~*()', 't1': ';,/?:@&=+$' });\r\n\r\n\t\t\t\tlet value = (oidcSecurityService as any).createAuthorizeUrl('nonce', 'state', 'http://example');\r\n\t\t\t\tlet expectValue = 'http://example?client_id=188968487735-b1hh7k87nkkh6vv84548sinju2kpr7gn.apps.googleusercontent.com&redirect_uri=https%3A%2F%2Flocalhost%3A44386&response_type=id_token%20token&scope=openid%20email%20profile&nonce=nonce&state=state&t4=ABC%20abc%20123&t3=%23&t2=-_.!~*()&t1=%3B%2C%2F%3F%3A%40%26%3D%2B%24';\r\n\t\t\t\texpect(value).toEqual(expectValue);\r\n\t\t\t})\r\n\t);\r\n\r\n\tit('createEndSessionUrl default',\r\n\t\tinject([OidcSecurityService],\r\n\t\t\t(oidcSecurityService: OidcSecurityService) => {\r\n\r\n\t\t\t\tlet openIDImplicitFlowConfiguration = new OpenIDImplicitFlowConfiguration();\r\n\t\t\t\topenIDImplicitFlowConfiguration.stsServer = 'https://localhost:5001';\r\n\t\t\t\topenIDImplicitFlowConfiguration.redirect_url = 'https://localhost:44386';\r\n\t\t\t\topenIDImplicitFlowConfiguration.client_id = '188968487735-b1hh7k87nkkh6vv84548sinju2kpr7gn.apps.googleusercontent.com';\r\n\t\t\t\topenIDImplicitFlowConfiguration.response_type = 'id_token token';\r\n\t\t\t\topenIDImplicitFlowConfiguration.scope = 'openid email profile';\r\n\t\t\t\topenIDImplicitFlowConfiguration.post_logout_redirect_uri = 'https://localhost:44386/Unauthorized';\r\n\t\t\t\topenIDImplicitFlowConfiguration.post_login_route = '/home';\r\n\t\t\t\topenIDImplicitFlowConfiguration.forbidden_route = '/Forbidden';\r\n\t\t\t\topenIDImplicitFlowConfiguration.unauthorized_route = '/Unauthorized';\r\n\t\t\t\topenIDImplicitFlowConfiguration.start_checksession = false;\r\n\t\t\t\topenIDImplicitFlowConfiguration.silent_renew = false;\r\n\t\t\t\topenIDImplicitFlowConfiguration.silent_renew_offset_in_seconds = 0;\r\n\t\t\t\topenIDImplicitFlowConfiguration.log_console_warning_active = true;\r\n\t\t\t\topenIDImplicitFlowConfiguration.log_console_debug_active = true;\r\n\t\t\t\topenIDImplicitFlowConfiguration.max_id_token_iat_offset_allowed_in_seconds = 10;\r\n\t\t\t\topenIDImplicitFlowConfiguration.override_well_known_configuration = true;\r\n\t\t\t\topenIDImplicitFlowConfiguration.override_well_known_configuration_url = 'https://localhost:44386/wellknownconfiguration.json';\r\n\r\n\t\t\t\t(oidcSecurityService as any).authConfiguration.init(openIDImplicitFlowConfiguration);\r\n\r\n\t\t\t\tlet value = (oidcSecurityService as any).createEndSessionUrl('http://example', 'mytoken');\r\n\t\t\t\tlet expectValue = 'http://example?id_token_hint=mytoken&post_logout_redirect_uri=https%3A%2F%2Flocalhost%3A44386%2FUnauthorized';\r\n\t\t\t\texpect(value).toEqual(expectValue);\r\n\t\t\t})\r\n\t);\r\n\r\n\r\n});\r\n"]}